{"title":"CentOS安装使用，远程连接MySql","date":"2019-09-20T19:17:32.000Z","link":"2019/09/21/CentOS安装使用 基础操作 远程连接MySql","tags":["MySql","原创"],"updated":"2019-11-08T07:17:52.580Z","content":"<h4 id=\"安装\">安装<a href=\"2019/09/21/CentOS安装使用 基础操作 远程连接MySql#安装\"></a></h4><p>获取mysql的rpm yum包</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm</span><br></pre></td></tr></table></div></figure>\n\n<p>安装rpm</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm -ivh mysql-community-release-el7-5.noarch.rpm</span><br></pre></td></tr></table></div></figure>\n\n<p>安装</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mysql-community-server</span><br></pre></td></tr></table></div></figure>\n\n<p>启动</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysqld start</span><br></pre></td></tr></table></div></figure>\n\n<p>查看是否运行</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service mysqld status</span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"初始配置\">初始配置<a href=\"2019/09/21/CentOS安装使用 基础操作 远程连接MySql#初始配置\"></a></h4><p>进入mysql控制台，输入密码时直接回车。或者进入/var/log/mysqld.log查看密码</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p mysql</span><br></pre></td></tr></table></div></figure>\n\n<p>修改密码</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update user set password=PASSWORD(&apos;qwer1234&apos;) where user=&apos;root&apos;;</span><br></pre></td></tr></table></div></figure>\n\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.  grant all privileges on *.* to &apos;root&apos;@&apos;%&apos; identified by &apos;qwer1234&apos; with grant option;  </span><br><span class=\"line\">//root 是用户名，% 表示任意主机，&apos;123456&apos; 指定的登录密码</span><br><span class=\"line\">（这个和本地的root密码可以设置不同，互不影响）  </span><br><span class=\"line\">2.  flush privileges; //重载系统权限  </span><br><span class=\"line\">3.  exit;//退出mysql控制台</span><br></pre></td></tr></table></div></figure>\n\n<p>开放3306端口</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iptables -I INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT</span><br></pre></td></tr></table></div></figure>\n\n<h5 id=\"彻底卸载Mysql\">彻底卸载Mysql<a href=\"2019/09/21/CentOS安装使用 基础操作 远程连接MySql#彻底卸载Mysql\"></a></h5><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.查看mysql的安装情况</span><br><span class=\"line\">       rpm -qa|grep -i mysql</span><br><span class=\"line\">       </span><br><span class=\"line\">2.停止mysql服务，删除mysql</span><br><span class=\"line\">       rpm -ev mysql-5.1.73-8.el6_8.x86_64</span><br><span class=\"line\">       rpm -ev mysql-libs-5.1.73-8.el6_8.x86_64</span><br><span class=\"line\">注意：可能会抛依赖错误错 error:Failed dependencies:</span><br><span class=\"line\">，则加上 --nodeps不检查依赖关系删除，命令如下</span><br><span class=\"line\">rpm -e --nodeps mysql-libs-5.1.73-8.el6_8.x86_64</span><br><span class=\"line\"></span><br><span class=\"line\">3.删除遗留的mysql文件和依赖库</span><br><span class=\"line\">find / -name mysql</span><br><span class=\"line\">rm -rf /var/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">4.mysql 配置文件还要手动删除</span><br><span class=\"line\">rm -rf /etc/my.cnf</span><br><span class=\"line\"></span><br><span class=\"line\">5.检查一遍mysql 是否成功删除</span><br><span class=\"line\">rpm -qa|grep -i mysql</span><br></pre></td></tr></table></div></figure>\n\n<h5 id=\"mysql忘记密码\">mysql忘记密码<a href=\"2019/09/21/CentOS安装使用 基础操作 远程连接MySql#mysql忘记密码\"></a></h5><h6 id=\"修改my-cnf文件，一般在-etc目录下，在此配置文件中添加一行代码。skip-grant-tables，意思为忽略登陆密码。\">修改my.cnf文件，一般在/etc目录下，在此配置文件中添加一行代码。skip-grant-tables，意思为忽略登陆密码。<a href=\"2019/09/21/CentOS安装使用 基础操作 远程连接MySql#修改my-cnf文件，一般在-etc目录下，在此配置文件中添加一行代码。skip-grant-tables，意思为忽略登陆密码。\"></a></h6><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># For advice on how to change settings please see</span><br><span class=\"line\"># http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">#</span><br><span class=\"line\"># Remove leading # and set to the amount of RAM for the most important data</span><br><span class=\"line\"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span><br><span class=\"line\"># innodb_buffer_pool_size = 128M</span><br><span class=\"line\">#</span><br><span class=\"line\"># Remove leading # to turn on a very important data integrity option: logging</span><br><span class=\"line\"># changes to the binary log between backups.</span><br><span class=\"line\"># log_bin</span><br><span class=\"line\">#</span><br><span class=\"line\"># Remove leading # to set options mainly useful for reporting servers.</span><br><span class=\"line\"># The server defaults are faster for transactions and fast SELECTs.</span><br><span class=\"line\"># Adjust sizes as needed, experiment to find the optimal values.</span><br><span class=\"line\"># join_buffer_size = 128M</span><br><span class=\"line\"># sort_buffer_size = 2M</span><br><span class=\"line\"># read_rnd_buffer_size = 2M</span><br><span class=\"line\">datadir=/var/lib/mysql</span><br><span class=\"line\">socket=/var/lib/mysql/mysql.sock</span><br><span class=\"line\"></span><br><span class=\"line\"># 添加这行代码</span><br><span class=\"line\">skip-grant-tables</span><br><span class=\"line\"></span><br><span class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</span><br><span class=\"line\">symbolic-links=0</span><br><span class=\"line\"></span><br><span class=\"line\"># Recommended in standard MySQL setup</span><br><span class=\"line\">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES </span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld_safe]</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class=\"line\">max_allowed_packet = 50M</span><br><span class=\"line\"></span><br><span class=\"line\">[client]</span><br><span class=\"line\">default-character-set = utf8mb4</span><br><span class=\"line\"></span><br><span class=\"line\">[mysql]</span><br><span class=\"line\">default-character-set = utf8mb4</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">character-set-client-handshake = FALSE</span><br><span class=\"line\">character_set_server = utf8mb4</span><br><span class=\"line\">collation-server = utf8mb4_unicode_ci</span><br><span class=\"line\">init_connect=&apos;SET NAMES utf8mb4&apos;</span><br></pre></td></tr></table></div></figure>\n\n<p>重启mysql</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@VM_0_3_centos etc]<span class=\"comment\"># systemctl restart mysqld.service</span></span><br></pre></td></tr></table></div></figure>\n\n<p>进入myql</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@VM_0_3_centos etc]<span class=\"comment\"># mysql</span></span><br></pre></td></tr></table></div></figure>\n\n<p>在mysql中，修改root密码</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; use mysql;</span><br><span class=\"line\">mysql&gt; update mysql.user set authentication_string=password(&apos;password&apos;) where user=&apos;root&apos;;</span><br></pre></td></tr></table></div></figure>\n\n<p>flush一下，然后退出</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; flush privileges;</span><br><span class=\"line\">mysql&gt; quit;</span><br></pre></td></tr></table></div></figure>\n\n<p>最后一定要改回配置（删除skip-grant-tables），然后重启。</p>\n","prev":{"title":"centOS安装操作Docker","link":"2019/09/21/centOS安装操作Docker"},"next":{"title":"Java学习笔记","link":"2019/09/21/Java学习笔记"},"plink":"http://yoursite.com/2019/09/21/CentOS安装使用 基础操作 远程连接MySql/"}