{"title":"【转载】Linux之nginx","date":"2019-09-28T16:11:42.000Z","link":"2019/09/29/【转载】Linux之nginx","tags":["Linux","Nginx"],"updated":"2019-11-02T06:56:50.732Z","content":"<p><img src=\"http://148.70.50.70/source/1569684988970.jpg\" alt=\"image.png\" class=\"article-img\"></p>\n<p>Nginx(“engine x”)是一款是由俄罗斯的程序设计师Igor Sysoev所开发高性能的 Web和 反向代理 服务器，也是一个 IMAP/POP3/SMTP 代理服务器。在高连接并发的情况下，Nginx是Apache服务器不错的替代品。</p>\n<h2 id=\"Nginx-安装\">Nginx 安装<a href=\"2019/09/29/【转载】Linux之nginx#Nginx-安装\"></a></h2><p>系统平台：CentOS release 6.6 (Final) 64位。</p>\n<h3 id=\"一、安装编译工具及库文件\">一、安装编译工具及库文件<a href=\"2019/09/29/【转载】Linux之nginx#一、安装编译工具及库文件\"></a></h3><figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install make zlib zlib-devel gcc-c++ libtool  openssl openssl-devel</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"二、首先要安装-PCRE\">二、首先要安装 PCRE<a href=\"2019/09/29/【转载】Linux之nginx#二、首先要安装-PCRE\"></a></h3><p>PCRE 作用是让 Nginx 支持 Rewrite 功能。</p>\n<p>1、下载 PCRE 安装包，下载地址： <a href=\"http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz\" target=\"_blank\" rel=\"noopener\">http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz</a></p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# cd /usr/local/src/</span><br><span class=\"line\">[root@bogon src]# wget http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx1.png\" alt=\"img\" class=\"article-img\"></p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# tar zxvf pcre-8.35.tar.gz</span><br></pre></td></tr></table></div></figure>\n\n<p>3、进入安装包目录</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# cd pcre-8.35</span><br></pre></td></tr></table></div></figure>\n\n<p>4、编译安装 </p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon pcre-8.35]# ./configure</span><br><span class=\"line\">[root@bogon pcre-8.35]# make &amp;&amp; make install</span><br></pre></td></tr></table></div></figure>\n\n<p>5、查看pcre版本</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon pcre-8.35]# pcre-config --version</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx2.png\" alt=\"img\" class=\"article-img\"></p>\n<p>1、下载 Nginx，下载地址：<a href=\"http://nginx.org/download/nginx-1.6.2.tar.gz\" target=\"_blank\" rel=\"noopener\">http://nginx.org/download/nginx-1.6.2.tar.gz</a></p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# cd /usr/local/src/</span><br><span class=\"line\">[root@bogon src]# wget http://nginx.org/download/nginx-1.6.2.tar.gz</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx3.png\" alt=\"img\"> 2、解压安装包</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# tar zxvf nginx-1.6.2.tar.gz</span><br></pre></td></tr></table></div></figure>\n\n<p>3、进入安装包目录</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon src]# cd nginx-1.6.2</span><br></pre></td></tr></table></div></figure>\n\n<p>4、编译安装</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon nginx-1.6.2]# ./configure --prefix=/usr/local/webserver/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre=/usr/local/src/pcre-8.35</span><br><span class=\"line\">[root@bogon nginx-1.6.2]# make</span><br><span class=\"line\">[root@bogon nginx-1.6.2]# make install</span><br></pre></td></tr></table></div></figure>\n\n<p>5、查看nginx版本</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon nginx-1.6.2]# /usr/local/webserver/nginx/sbin/nginx -v</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx4.png\" alt=\"img\" class=\"article-img\"></p>\n<hr>\n<h2 id=\"Nginx-配置\">Nginx 配置<a href=\"2019/09/29/【转载】Linux之nginx#Nginx-配置\"></a></h2><p>创建 Nginx 运行使用的用户 www：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon conf]# /usr/sbin/groupadd www </span><br><span class=\"line\">[root@bogon conf]# /usr/sbin/useradd -g www www</span><br></pre></td></tr></table></div></figure>\n\n<p>配置nginx.conf ，将/usr/local/webserver/nginx/conf/nginx.conf替换为以下内容</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon conf]#  cat /usr/local/webserver/nginx/conf/nginx.conf</span><br><span class=\"line\"></span><br><span class=\"line\">user www www;</span><br><span class=\"line\">worker_processes 2; #设置值和CPU核心数一致</span><br><span class=\"line\">error_log /usr/local/webserver/nginx/logs/nginx_error.log crit; #日志位置和日志级别</span><br><span class=\"line\">pid /usr/local/webserver/nginx/nginx.pid;</span><br><span class=\"line\">#Specifies the value for maximum file descriptors that can be opened by this process.</span><br><span class=\"line\">worker_rlimit_nofile 65535;</span><br><span class=\"line\">events</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  use epoll;</span><br><span class=\"line\">  worker_connections 65535;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  include mime.types;</span><br><span class=\"line\">  default_type application/octet-stream;</span><br><span class=\"line\">  log_format main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class=\"line\">               &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class=\"line\">               &apos;&quot;$http_user_agent&quot; $http_x_forwarded_for&apos;;</span><br><span class=\"line\">  </span><br><span class=\"line\">#charset gb2312;</span><br><span class=\"line\">     </span><br><span class=\"line\">  server_names_hash_bucket_size 128;</span><br><span class=\"line\">  client_header_buffer_size 32k;</span><br><span class=\"line\">  large_client_header_buffers 4 32k;</span><br><span class=\"line\">  client_max_body_size 8m;</span><br><span class=\"line\">     </span><br><span class=\"line\">  sendfile on;</span><br><span class=\"line\">  tcp_nopush on;</span><br><span class=\"line\">  keepalive_timeout 60;</span><br><span class=\"line\">  tcp_nodelay on;</span><br><span class=\"line\">  fastcgi_connect_timeout 300;</span><br><span class=\"line\">  fastcgi_send_timeout 300;</span><br><span class=\"line\">  fastcgi_read_timeout 300;</span><br><span class=\"line\">  fastcgi_buffer_size 64k;</span><br><span class=\"line\">  fastcgi_buffers 4 64k;</span><br><span class=\"line\">  fastcgi_busy_buffers_size 128k;</span><br><span class=\"line\">  fastcgi_temp_file_write_size 128k;</span><br><span class=\"line\">  gzip on; </span><br><span class=\"line\">  gzip_min_length 1k;</span><br><span class=\"line\">  gzip_buffers 4 16k;</span><br><span class=\"line\">  gzip_http_version 1.0;</span><br><span class=\"line\">  gzip_comp_level 2;</span><br><span class=\"line\">  gzip_types text/plain application/x-javascript text/css application/xml;</span><br><span class=\"line\">  gzip_vary on;</span><br><span class=\"line\"> </span><br><span class=\"line\">  #limit_zone crawler $binary_remote_addr 10m;</span><br><span class=\"line\"> #下面是server虚拟主机的配置</span><br><span class=\"line\"> server</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    listen 80;#监听端口</span><br><span class=\"line\">    server_name localhost;#域名</span><br><span class=\"line\">    index index.html index.htm index.php;</span><br><span class=\"line\">    root /usr/local/webserver/nginx/html;#站点目录</span><br><span class=\"line\">      location ~ .*\\.(php|php5)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      #fastcgi_pass unix:/tmp/php-cgi.sock;</span><br><span class=\"line\">      fastcgi_pass 127.0.0.1:9000;</span><br><span class=\"line\">      fastcgi_index index.php;</span><br><span class=\"line\">      include fastcgi.conf;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf|ico)$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      expires 30d;</span><br><span class=\"line\">  # access_log off;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ .*\\.(js|css)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      expires 15d;</span><br><span class=\"line\">   # access_log off;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    access_log off;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<p>检查配置文件nginx.conf的正确性命令：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon conf]# /usr/local/webserver/nginx/sbin/nginx -t</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx5.png\" alt=\"img\" class=\"article-img\"></p>\n<h2 id=\"启动-Nginx\">启动 Nginx<a href=\"2019/09/29/【转载】Linux之nginx#启动-Nginx\"></a></h2><p>Nginx 启动命令如下：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@bogon conf]# /usr/local/webserver/nginx/sbin/nginx</span><br></pre></td></tr></table></div></figure>\n\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx6.png\" alt=\"img\" class=\"article-img\"></p>\n<h2 id=\"访问站点\">访问站点<a href=\"2019/09/29/【转载】Linux之nginx#访问站点\"></a></h2><p>从浏览器访问我们配置的站点ip：</p>\n<p><img src=\"https://www.runoob.com/wp-content/uploads/2015/01/nginx7.png\" alt=\"img\" class=\"article-img\"></p>\n<h2 id=\"Nginx-其他命令\">Nginx 其他命令<a href=\"2019/09/29/【转载】Linux之nginx#Nginx-其他命令\"></a></h2><p>以下包含了 Nginx 常用的几个命令：</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/local/webserver/nginx/sbin/nginx -s reload            # 重新载入配置文件</span><br><span class=\"line\">/usr/local/webserver/nginx/sbin/nginx -s reopen            # 重启 Nginx</span><br><span class=\"line\">/usr/local/webserver/nginx/sbin/nginx -s stop              # 停止 Nginx</span><br></pre></td></tr></table></div></figure>","prev":{"title":"京东爬虫python+selenium+requests","link":"2019/09/29/京东爬虫python+selenium+requests"},"next":{"title":"【转载】vue+animate使用过度动画","link":"2019/09/29/【转载】vue+animate使用过度动画"},"plink":"http://yoursite.com/2019/09/29/【转载】Linux之nginx/","toc":[{"title":"Nginx 安装","id":"Nginx-安装","index":"1","children":[{"title":"一、安装编译工具及库文件","id":"一、安装编译工具及库文件","index":"1.1"},{"title":"二、首先要安装 PCRE","id":"二、首先要安装-PCRE","index":"1.2"}]},{"title":"Nginx 配置","id":"Nginx-配置","index":"2"},{"title":"启动 Nginx","id":"启动-Nginx","index":"3"},{"title":"访问站点","id":"访问站点","index":"4"},{"title":"Nginx 其他命令","id":"Nginx-其他命令","index":"5"}]}